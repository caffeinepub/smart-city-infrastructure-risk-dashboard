{
  "kind": "coverage_report",
  "version": "1.0",
  "generatedAt": "2026-02-24T21:58:51.317Z",
  "sources": {
    "buildRequest": true,
    "implementationPlan": true
  },
  "requirements": {
    "total": 5,
    "implemented": 3,
    "items": [
      {
        "id": "REQ-16",
        "summary": "Add a photo upload field to the infrastructure add/edit form. Accept JPEG/PNG images (max 5MB). Store the uploaded image as a Base64-encoded blob in the backend Infrastructure record by adding an optional `photoBase64: ?Text` field to the Motoko data type. Update `addInfrastructure` and `updateInfrastructure` to accept and persist this field.",
        "status": "unknown",
        "plannedFiles": [],
        "matchedFiles": []
      },
      {
        "id": "REQ-17",
        "summary": "Implement a deterministic image-based condition analysis function in Motoko. When a photo is uploaded alongside infrastructure parameters, derive a simulated visual condition score (0.0â€“5.0) from the Base64 image hash combined with structural parameters (age, materialType, environmentalExposureFactor). Use this derived score to auto-compute and return: riskScore, riskLevel, deteriorationRate, predicted maintenanceYear, and budgetEstimate. Expose this as a query/update function `analyzeAndPredict(record: InfrastructureInput): PredictionResult`.",
        "status": "unknown",
        "plannedFiles": [],
        "matchedFiles": []
      },
      {
        "id": "REQ-18",
        "summary": "Add a React Query hook `useAnalyzeAndPredict` in `frontend/src/hooks/useQueries.ts` that calls the backend `analyzeAndPredict` function with infrastructure form data including the uploaded photo Base64 string.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/hooks/useQueries.ts"
        ],
        "matchedFiles": [
          "frontend/src/hooks/useQueries.ts"
        ]
      },
      {
        "id": "REQ-19",
        "summary": "Build a new 'Add / Analyze Infrastructure' page (route `/add`) accessible from the top navigation bar. The page must include: a full infrastructure details form (name, structureType, area, age, trafficLoadFactor, materialType, environmentalExposureFactor, structuralConditionRating, notes), a photo upload widget with drag-and-drop and file-picker support showing a preview thumbnail, an 'Analyze & Predict' button that calls the backend analyzeAndPredict function, and an auto-populated Prediction Results panel that appears after analysis showing: risk score with colored badge, risk level, health score progress bar, deterioration rate, forecasted maintenance year, estimated budget cost, and recommended action. A 'Save to Database' button saves the record (with photo) to the backend.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/pages/AddInfrastructure.tsx",
          "frontend/src/components/PhotoUpload.tsx",
          "frontend/src/components/PredictionResultsPanel.tsx",
          "frontend/src/App.tsx",
          "frontend/src/components/Layout.tsx"
        ],
        "matchedFiles": [
          "frontend/src/pages/AddInfrastructure.tsx",
          "frontend/src/components/PhotoUpload.tsx",
          "frontend/src/components/PredictionResultsPanel.tsx",
          "frontend/src/App.tsx",
          "frontend/src/components/Layout.tsx"
        ]
      },
      {
        "id": "REQ-20",
        "summary": "Update the existing `InfrastructureEditForm` component to include a photo upload field. When a new photo is uploaded on an existing record, re-run the analyzeAndPredict function and show updated prediction suggestions in a side panel next to the form. The user can accept the suggested values (auto-fill form fields) or dismiss them.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/components/InfrastructureEditForm.tsx",
          "frontend/src/components/PredictionSuggestionsPanel.tsx",
          "frontend/src/pages/InfrastructureDetail.tsx"
        ],
        "matchedFiles": [
          "frontend/src/components/InfrastructureEditForm.tsx",
          "frontend/src/components/PredictionSuggestionsPanel.tsx",
          "frontend/src/pages/InfrastructureDetail.tsx"
        ]
      }
    ]
  },
  "changedFiles": [
    "backend/authorization/MixinAuthorization.mo",
    "backend/authorization/access-control.mo",
    "backend/main.mo",
    "backend/migration.mo",
    "build-request.json",
    "build-template/README.md",
    "caffeine.lock.json",
    "feature_evidence.json",
    "frontend-file-summaries.txt",
    "frontend-implementation-plan.json",
    "frontend/src/App.tsx",
    "frontend/src/backend.d.ts",
    "frontend/src/backend.ts",
    "frontend/src/components/InfrastructureEditForm.tsx",
    "frontend/src/components/Layout.tsx",
    "frontend/src/components/PhotoUpload.tsx",
    "frontend/src/components/PredictionResultsPanel.tsx",
    "frontend/src/components/PredictionSuggestionsPanel.tsx",
    "frontend/src/declarations/backend.did.d.ts",
    "frontend/src/declarations/backend.did.js",
    "frontend/src/hooks/useActor.ts",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/pages/AddInfrastructure.tsx",
    "frontend/src/pages/InfrastructureDetail.tsx",
    "frontend/src/utils/urlParams.ts",
    "project_state.json",
    "scratch/component-selection.json",
    "spec.md",
    "spec_vs_diff_report.json"
  ]
}